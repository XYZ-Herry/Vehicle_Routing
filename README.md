# 车辆与无人机混合配送路径规划系统

## 项目介绍

本项目实现了一套复杂的车辆与无人机混合配送路径规划系统，旨在解决物流配送中的时间和成本优化问题。系统采用分层优化策略，分为静态阶段和动态阶段，能够应对多约束条件下的任务分配与路径规划，并支持车辆与无人机的协同工作。

## 系统特点

- **分层优化策略**：将问题分为静态和动态两个阶段，提高解决方案的稳定性和灵活性
- **多约束路径规划**：同时考虑电量、载重和时间约束
- **车机协同机制**：无人机可与车辆协同工作，扩大配送范围
- **动态任务调度**：自动识别延迟任务和新增需求点，进行重新调度
- **高峰期影响建模**：通过速度调整模拟交通拥堵对配送时间的影响

## 技术架构

### 核心算法

1. **遗传算法**：用于任务分配优化
   - 静态阶段：按配送中心分别进行，为各中心的车辆分配任务点
   - 动态阶段：在静态最优解基础上，允许延迟任务和新增任务分配给任意车辆

2. **改进最近邻算法**：
   - 普通车辆路径规划：考虑高峰期影响，选择最短距离路径
   - 无人机路径规划：同时考虑电量和载重约束，支持车机协同

### 系统流程

```
1. 数据预处理：读入并处理所有输入数据
2. 任务初始分配：每个任务点分配到距离最近的配送中心
3. 静态阶段遗传算法：分配任务点给各车辆
4. 静态阶段路径优化：优化各车辆/无人机的路径
5. 识别动态阶段任务：延迟任务和新增任务
6. 动态阶段遗传算法：重新分配任务点
7. 动态阶段路径优化：考虑车机协同优化所有路径
8. 输出最终路径和时间表
```

## 使用说明

### 运行环境要求

- C++17 或更高版本
- CMake 3.10 或更高版本
- 支持 C++17 的编译器（如 GCC 9.0+, Clang 10.0+）

### 安装与编译

```bash
# 克隆代码库
git clone [repository-url]
cd vehicle-routing

# 编译项目
mkdir -p build
cd build
cmake ..
make
```

### 运行程序

```bash
# 使用默认输入文件
./build_and_run.sh

# 使用指定的输入文件
./build_and_run.sh ../test/1.txt
```

### 输入数据格式

输入文件包含以下信息：
- 配送中心数量和位置
- 车辆和无人机信息（包括速度、载重、电量等）
- 任务点信息（位置、取货/送货需求、到达时间等）
- 高峰期信息

### 输出结果

程序输出包括：
- 静态阶段优化结果
- 动态阶段任务识别结果
- 最终配送路径和时间安排
- 总配送时间和成本计算

## 文件结构

```
├── include/             # 头文件
├── src/                 # 源代码
│   ├── main.cpp         # 主程序入口
│   ├── common.cpp       # 公共函数和数据结构
│   ├── task_assigner.cpp # 任务分配器
│   ├── static_genetic.cpp # 静态阶段遗传算法
│   ├── dynamic_genetic.cpp # 动态阶段遗传算法
│   ├── path_optimizer.cpp # 路径优化算法
│   └── solver.cpp       # 问题求解器
├── test/                # 测试数据
├── docs/                # 文档
│   └── Algorithm_Introduction.md # 算法详细介绍
├── build_and_run.sh     # 构建和运行脚本
├── CMakeLists.txt       # CMake构建文件
└── README.md            # 项目说明
```

## 算法复杂度

- 初始任务分配：O(m×n)，其中m为配送中心数量，n为任务点数量
- 静态阶段遗传算法：O(g×p×n²)，其中g为代数，p为种群大小，n为任务点数量
- 路径优化：O(n²)，其中n为分配给单个车辆的任务点数量
- 动态阶段遗传算法：O(g×p×n²)
- 车机协同路径规划：O(v×n²)，其中v为车辆数量，n为任务点数量

## 许可证

本项目基于 [MIT 许可证](LICENSE)。
